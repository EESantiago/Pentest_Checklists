# Scanning

## Automated Enumeration Tools

The below tools can be used to automate the survey ad prviliege escalation process.  Reference the source documentation for usage of each tool.  If you plan to use these, run as many as you can as each each one offers different outputs and recommendations that others do not:

#### Bat scripts and Executables

* [reonnoiter](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)
       ```
       reconnoitre -t <IP_ADDR> -o <OUTPUT_DIRECTORY> --services
       ```
* [nmapAutomator](https://github.com/21y4d/nmapAutomator)
* sparta 
* unircorn scan
* onetowpunch 

<br/>

## Host Discovery

Ping sweep:
```
nmap -sP <TARGET_RANGE>
nmap -sn <TARGET_RANGE>

# ping sweep and send the the list of IPs that are up to a seperate file
nmap -sP <TARGETRANGE> | grep -B1 'Host is up' | egrep -o '([0-9]{1,3}\.){3}[0-9]{1,3}' > ips.txt
```

Netdiscover is an active/passive ARP reconnaissance tool that uses the Address Resolution Protocol (ARP) to find live hosts on a local network:
```
netdiscover -r 10.11.1.0/24
```
### Port Scanning  

My preferred scan (all ports, no host discovery, versions, and default scripts):
```
nmap -sC -sV -Pm -p- <IP_ADDRESS>
```

Single port:
```
nmap -Pn -p <IP_ADDRESS>
nc -nzv <IP_ADDDRESS> <PORT>
```
Other nmap scans:
```
# TCP Connect
nmap -sT -Pn <IP_ADDRESS>

# TCP SYN (must use sudo)
nmap -sS -Pn <IP_ADDRESS>

# Aggressive
nmap -A -Pn <IP_ADDRESS>
```

Scan all ports on all target devices discovered previously
```
nmap -sC -sV -Pn -p- -iL ips.txt
```

Metasploit SYN scan
```
msf > db_nmap -sS -n <Target_IP> -p 0-65535
```

Banner grabbing:
```
nc -nv <IP_ADDDRESS> <PORT>
nmap -sV --script=banner -p <port> <ip>
```

list nmap scripts:

ls -l /usr/share/nmap/scripts/ftp*

unicornscan
massscan

add to services:

HTTP: ls -l /usr/share/nmap/scripts/http*

SMTP: ls -l /usr/share/nmap/scripts/smtp*

SMB: ls -l /usr/share/nmap/scripts/smb*

MySQL: ls -l /usr/share/nmap/scripts/mysql*

WordPress: ls -l /usr/share/nmap/scripts/http-wordpress*

Drupal: ls -l /usr/share/nmap/scripts/http-drupal*

Citrix: ls -l /usr/share/nmap/scripts/citrix*





### DNS Enumeration 

The information retrieved during DNS enumeration will consist of details about names servers and IP addresses of potential targets (such as mail servers, sub-domains etc).

Gather general information about the domain such as the registrar, domain owner, their contact information and the DNS server used:
```
whois <DOMAIN>

# determine a target's nameservers
host -t ns google.com
```
Use 'nslookup' for querying the domain name system in order to obtain DNS records (IP Address):
```
nslookup <DOMAIN>

# query a specific record
nslookup -type=<RECORD> <DOMAIN>

# mail exchange example
nslookup -type=mx google.com

# lookup but specify DNS server to use
nslookup -type=any google.com 8.8.8.8
```
Resolce hostname to IP address:
```
host <DOMAIN>
```







