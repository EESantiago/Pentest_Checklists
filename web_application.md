# Web Application Penetration Testing

### Local File Inclusion

File Inclusion vulnerabilities are commonly found in poorly written PHP web-applications where the input parameters are not properly sanitized or validated

Local file inclusion is the vulnerability in which an attacker tries to trick the web-application by including the files that are already present locally into the server. It arises when a php file contains some php functions such as “include”, “include_once”, “require”, “require_once”.

https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/


tool: https://github.com/D35m0nd142/LFISuite
tool: https://github.com/P0cL4bs/kadimus

### Wordpress enumeration 

nmap --script=/usr/share/nmap/scripts/http-wordpress-users.nse -sV -Pn -p 80 10.12.1.7

enum plugins
```
wpscan --url <IP> --enumerate p
 ```
enumerate vuln plugins
```
 wpscan --url <IP> --enumerate vp
 ```
 # use the api token so that yoou actually see vulnerabilites
 ```
wpscan --url http://10.12.1.192 --enumerate vp --api-token <API TOKEN>
```

### Brute Force web Login Pages

#### Generating password lists

```
crunch [min length] [max length] [charset] [options]

# 4 capital letters from the alphabet in all their possible combinations
crunch 4 4 ABCDEFGHIJKLMNOPQRSTUVWXYZ -o /root/Desktop/wordlist.txt

# passwords with all the possible combinations for 5 digits
crunch 5 5 0123456789 -o /root/Desktop/numbers.txt

# 4 capital letters in all possible combinations followed by the number 1980
crunch 8 8 ABCDEFGHIJKLMNOPQRSTUVWXYZ -t @@@@1980 -o /root/Desktop/wordlist.txt
```

Cewl examples:
```
# 8 letters or more and go 1 level deep
cewl -d 1 -m 8 -w /root/Desktop/cewl.txt https://www.kali.org
```
#### Burpsuite 

First ensure to capture the message displayed when an incorret login is entered, such as *Login Faild*

Now complete the following in Burpsuite

1. Capture an HTTP request
2. Send to Intruder
3

Bruteforce with hydra:
```
hydra 10.11.1.250 -t 2 -l admin -P /usr/share/wordlists/rockyou.txt http-post-form “</PATH/TO/LOGIN_PAGE>:username=^USER^&password=^PASS^&Login=Login:<FAILED_LOGIN_MESSAGE>”
```

### Subdoamin enumerations

#### Subliste3r

```
# default scan
sublist3r -d <DOMAIN>

# brute force scan with addtional threads:
sublist3r -d google.com -b -t 100 -e <DOMAIN> -v
```


### Passive information Gathering Websites

https://www.google.com
https://www.google.com/maps
https://www.exploit-db.com/google-hacking-database/
https://www.shodan.io
https://www.tineye.com
https://www.netcraft.com
https://pastebin.com
https://haveibeenpwned.com

<br/>

### Email Harvesting

```
theHarvester -d <DOMAIN> -b <SEARCH ENGINE>
```

```
recon-ng

# costs money
marketplace install recon/contacts-credentials/hibp_breach

keys add hibp_api [API key]

modules load recon/contacts-credentials/hibp_breach

options set SOURCE <Target email address>
run
```


